{"version":3,"sources":["../src/AbstractStore.js"],"names":[],"mappings":";;;;;;;;;;;;;;IAAqB,aAAa;AACnB,aADM,aAAa,CAClB,EAAE,EAAE,OAAO,EAAE;8BADR,aAAa;;AAE1B,YAAI,CAAC,EAAE,GAAG,EAAE,CAAC;AACb,YAAI,CAAC,OAAO,GAAG,OAAO,CAAC;KAC1B;;iBAJgB,aAAa;;;;;iCAM1B,cAAC,MAAM,EAAE;AACT,mBAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACpC;;;;;;6BAEG,cAAC,EAAE,EAAE;AACL,mBAAO,EAAE,CAAC;SACb;;;;;;kCAMU,qBAAC,OAAO,EAAE;;;AACjB,gBAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAC3B,gBAAI,CAAC,OAAO,CAAC,GAAG,EAAE;AACd,sBAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;aACtD;;AAED,mBAAO,CAAC,aAAa,GAAG,OAAO,CAAC,IAAI,KAAK,OAAO,CAAC,QAAQ,CAAC;AAC1D,mBAAO,CAAC,QAAQ,GAAG,EAAE,CAAC;AACtB,mBAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;AACxC,mBAAO,CAAC,IAAI,GAAG,eAAc,EAAE,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;AAC/C,mBAAO,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAC7B,mBAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAC,KAAK,EAAK;AACxC,oBAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,CAAC,EAAE;AACpC,0BAAM,IAAI,KAAK,CAAC,wBAAwB,GACxB,MAAK,OAAO,CAAC,EAAE,CAAC,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC,GAAG,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC,CAAC;iBACnF;aACJ,CAAC,CAAC;SACN;;;;;;kCAEU,qBAAC,OAAO,EAAE;;;AACjB,gBAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAC3B,gBAAI,CAAC,OAAO,CAAC,GAAG,EAAE;AACd,sBAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;aACtD;;AAED,mBAAO,CAAC,QAAQ,GAAG,EAAE,CAAC;AACtB,mBAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC;AACxC,mBAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAC,KAAK,EAAK;AACxC,oBAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,CAAC,EAAE;AACpC,0BAAM,IAAI,KAAK,CAAC,wBAAwB,GACxB,OAAK,OAAO,CAAC,EAAE,CAAC,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC,GAAG,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC,CAAC;iBACnF;aACJ,CAAC,CAAC;SACN;;;;;iCArCU,eAAG;AACV,mBAAO,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,IAAI,IAAI,CAAC;SAC1C;;;WAhBgB,aAAa;;;kBAAb,aAAa","file":"AbstractStore.js","sourcesContent":["export default class AbstractStore {\n    constructor(db, manager) {\n        this.db = db;\n        this.manager = manager;\n    }\n\n    toVO(result) {\n        return this.manager.toVO(result);\n    }\n\n    toId(id) {\n        return id;\n    }\n\n    get keyPath() {\n        return this.manager.VO.keyPath || 'id';\n    }\n\n    updateByKey(options) {\n        var keyPath = this.keyPath;\n        if (!options.key) {\n            throw new Error('Missing property key in options');\n        }\n\n        options.partialUpdate = options.data !== options.fullData;\n        options.criteria = {};\n        options.criteria[keyPath] = options.key;\n        options.data = Object.assign({}, options.data);\n        delete options.data[keyPath];\n        return this.update(options).then((count) => {\n            if (count !== undefined && count !== 1) {\n                throw new Error('Failed to updateByKey ' +\n                                this.manager.VO.name + ': ' + options.key + ' (' + count + ')');\n            }\n        });\n    }\n\n    removeByKey(options) {\n        var keyPath = this.keyPath;\n        if (!options.key) {\n            throw new Error('Missing property key in options');\n        }\n\n        options.criteria = {};\n        options.criteria[keyPath] = options.key;\n        return this.remove(options).then((count) => {\n            if (count !== undefined && count !== 1) {\n                throw new Error('Failed to removeByKey ' +\n                                this.manager.VO.name + ': ' + options.key + ' (' + count + ')');\n            }\n        });\n    }\n}\n"]}